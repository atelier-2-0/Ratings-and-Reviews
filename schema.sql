-- REVIEWS TABLE

DROP TABLE IF EXISTS reviews CASCADE;

CREATE TABLE reviews (
  id INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  product_id INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  date timestamp NOT NULL,
  reviewer_name VARCHAR (30) NOT NULL,
  reviewer_email VARCHAR (50) NOT NULL,
  rating SMALLINT NOT NULL,
  summary VARCHAR (60) NOT NULL,
  body TEXT NOT NULL,
  recommend SMALLINT NOT NULL,
  helpfulness SMALLINT NOT NULL,
  response TEXT NULL DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE (id)
);

-- CHARACTERISTICS TABLE

DROP TABLE IF EXISTS characteristics CASCADE;

CREATE TABLE characteristics (
  id INTEGER NOT NULL,
  name VARCHAR (60) NOT NULL,
  PRIMARY KEY (id),
  UNIQUE (id)
);

-- CHARACTERISTICS_REVIEWS TABLE

DROP TABLE IF EXISTS characteristics_reviews CASCADE;

CREATE TABLE characteristics_reviews (
  characteristics_id INTEGER NOT NULL,
  reviews_id INTEGER NOT NULL,
  value SMALLINT NOT NULL
);

ALTER TABLE characteristics_reviews ADD FOREIGN KEY (reviews_id) REFERENCES reviews (id);
ALTER TABLE characteristics_reviews ADD FOREIGN KEY (characteristics_id) REFERENCES characteristics (id);

-- PHOTOS TABLE

DROP TABLE IF EXISTS photos CASCADE;

CREATE TABLE photos (
  id INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  review_id INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
  url VARCHAR (100) NULL DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE (id)
);

ALTER TABLE photos ADD FOREIGN KEY (review_id) REFERENCES reviews (id);
